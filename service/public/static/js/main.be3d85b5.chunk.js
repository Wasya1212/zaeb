(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,a){},107:function(e,t,a){},108:function(e,t,a){},135:function(e,t){},138:function(e,t,a){},139:function(e,t,a){},140:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(22),o=a.n(r),c=a(14),i=(a(80),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function l(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var u=a(8),h=a(18),m=a(29),d="ADD_ARTICLE",p="ADD_TOKEN",f="ADD_AUTHENTICATION",g="REMOVE_AUTHENTICATION",v={articles:[],token:localStorage.getItem("token")||"",isAuthenticated:!1};var k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;return t.type===d?Object.assign({},e,{articles:e.articles.concat(t.payload)}):t.type===p?Object.assign({},e,{token:t.payload}):t.type===f?(console.log("add auth"),Object.assign({},e,{isAuthenticated:!0})):t.type===g?(console.log("remove auth"),Object.assign({},e,{isAuthenticated:!1})):e},E=Object(m.b)(k);function y(e){return{type:p,payload:e}}function b(){return{type:f}}function C(){return{type:g}}var w=a(16),O=a.n(w),S=a(2),N=a.n(S),_=a(3),j=a(4),I=a(6),D=a(5),U=a(7),A=(a(105),function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).showUserModal=function(e){a.setState({userModalIsOpen:!0,user:e})},a.closeUserModal=function(){a.setState({userModalIsOpen:!1,user:{}})},a.state={userModalIsOpen:!1,user:{}},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("ul",Object.assign({},this.props,{className:"users-search-list"}),this.props.users.map(function(t){return s.a.createElement("li",{className:"users-search-list__item",onClick:function(){e.showUserModal(t)}},s.a.createElement(T,{user:t}))})),s.a.createElement(O.a,{isOpen:this.state.userModalIsOpen,onRequestClose:this.closeUserModal,contentLabel:"Find users"},this.state.userModalIsOpen?s.a.createElement("div",null,s.a.createElement(x,{user:this.state.user}),s.a.createElement(u.b,{to:"/chat/conversation/"+this.state.user._id.toString(),onClick:this.closeUserModal},"Go to messaging")):null,s.a.createElement("button",{className:"close-modal-btn",onClick:this.closeUserModal},"Close modal")))}}]),t}(n.Component)),M=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).findUsers=function(e){N.a.post("/api/users",{name:e,token:localStorage.getItem("token")}).then(function(e){var t=e.data;a.setState({users:t})}).catch(function(e){console.log(e)})},a.handleUsersChange=function(e){""===e.target.value?a.setState({users:[]}):a.findUsers(e.target.value)},a.hideUsersList=function(e){setTimeout(function(){a.setState({checked:!1})},200)},a.showUsersList=function(e){a.setState({checked:!0})},a.state={users:[],checked:!1},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return s.a.createElement("form",{className:"users-search-form"},s.a.createElement("input",{onFocus:this.showUsersList,onBlur:this.hideUsersList,placeholder:"Users search...",onChange:this.handleUsersChange}),s.a.createElement(A,{hidden:!this.state.checked,users:this.state.users}))}}]),t}(n.Component),T=function(e){return s.a.createElement("div",Object.assign({},e,{className:"user-profile"}),s.a.createElement("div",{className:"user-profile__picture"},s.a.createElement("img",{src:e.user.info.photo||"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTc5zNZV5Uc6ZwS4JAxBVS0DiqUtIAR_Q5u6-G42vMfNk3mFFLj"})),s.a.createElement("div",{className:"user-profile__info"},s.a.createElement("div",{className:"user-profile__name"},e.user.info.name),s.a.createElement("div",{className:"user-profile__email"},e.user.email)))},x=function(e){var t=e.user;return s.a.createElement("div",{className:"user-info"},s.a.createElement("div",{className:"user-info__picture"},s.a.createElement("img",{src:t.info.photo||"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTc5zNZV5Uc6ZwS4JAxBVS0DiqUtIAR_Q5u6-G42vMfNk3mFFLj"})),s.a.createElement("ul",{className:"user-info__list"},s.a.createElement("li",{className:"user-info__name"},"name: ",t.info.name||""),s.a.createElement("li",{className:"user-info__email"},"email: ",t.email||""),s.a.createElement("li",{className:"user-info__post"},"post: ",t.info.post||""),s.a.createElement("li",{className:"user-info__salary"},"salary: ",t.info.salary||""," UAH"),s.a.createElement("li",{className:"user-info__work-time"},"workin time:",function(e){var t;try{t=(e.info.status.work_times.start||"")+" - "+(e.info.status.work_times.end||"")}catch(a){t=""}finally{return t}}(t)),s.a.createElement("li",{className:"user-info__work-days"},s.a.createElement("div",{className:-1==t.info.status.work_days.indexOf(1)?"day":"day active-day"},"Mn"),s.a.createElement("div",{className:-1==t.info.status.work_days.indexOf(2)?"day":"day active-day"},"Ts"),s.a.createElement("div",{className:-1==t.info.status.work_days.indexOf(3)?"day":"day active-day"},"Wd"),s.a.createElement("div",{className:-1==t.info.status.work_days.indexOf(4)?"day":"day active-day"},"Th"),s.a.createElement("div",{className:-1==t.info.status.work_days.indexOf(5)?"day":"day active-day"},"Fd"),s.a.createElement("div",{className:-1==t.info.status.work_days.indexOf(6)?"day":"day active-day"},"St"),s.a.createElement("div",{className:-1==t.info.status.work_days.indexOf(7)?"day":"day active-day"},"Sn"))))},W=function(e){function t(e){var a;Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).showUserModal=function(e){a.setState({userModalIsOpen:!0})},a.closeUserModal=function(){a.setState({userModalIsOpen:!1})},a.onFileChange=function(e){a.setState({selectedFile:e.target.files[0]})},a.onWorkDaysChange=function(e){e.target.checked?a.setState({workDays:a.state.workDays.concat(e.target.value)}):a.setState({workDays:a.state.workDays.filter(function(t){return t!=e.target.value})})},a.onSalaryChange=function(e){a.setState({salary:e.target.value})},a.onPostChange=function(e){a.setState({post:e.target.value})},a.onPhoneChange=function(e){a.setState({phone:e.target.value})},a.onStartWorkTimeChange=function(e){a.setState({startWorkTime:e.target.value})},a.onEndWorkTimeChange=function(e){a.setState({endWorkTime:e.target.value})},a.onSubmit=function(e){if(e.preventDefault(),!a.validateForm())return alert("Wrong data!"),!1;var t=new FormData;t.append("token",localStorage.getItem("token")),t.append("file",a.state.selectedFile),t.append("workDays",JSON.stringify(a.state.workDays)),t.append("salary",a.state.salary),t.append("post",a.state.post),t.append("startWorkTime",a.state.startWorkTime),t.append("endWorkTime",a.state.endWorkTime),t.append("phone",a.state.phone),t.append("avatarImage",a.state.avatarImage),N.a.post("/api/user/edit",t,{headers:{"content-type":"multipart/form-data"}}).then(function(e){var t=e.data;a.setState({updatedUser:t})}).then(function(){a.props.onUpdating(a.state.updatedUser)}).then(function(){a.closeUserModal()}).catch(function(e){console.error(e)})};try{a.state={userModalIsOpen:!1,selectedFile:null,workDays:a.props.user.info.status.work_days||[],salary:a.props.user.info.salary||0,post:a.props.user.info.post||"",startWorkTime:a.props.user.info.status.work_times.start||"",endWorkTime:a.props.user.info.status.work_times.end||"",phone:a.props.user.info.phone||"",avatarImage:a.props.user.info.photo||"",updatedUser:{}}}catch(n){console.log(n),a.state={userModalIsOpen:!1,selectedFile:null,workDays:[],salary:0,post:"",startWorkTime:"",endWorkTime:"",phone:"",avatarImage:"",updatedUser:{}}}return a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"validateForm",value:function(){var e=!0;return 0==/^((\+|38|0)+([0-9]){9})$/m.test(this.state.phone)&&""!=this.state.phone&&(e=!1),e}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("button",{className:"user-settings-btn",onClick:this.showUserModal},"Settings"),s.a.createElement(O.a,{isOpen:this.state.userModalIsOpen,onRequestClose:this.closeUserModal,contentLabel:"Find users"},s.a.createElement("form",{className:"user-settings-form",onSubmit:this.onSubmit},s.a.createElement("p",null,s.a.createElement("label",null,"Photo"),s.a.createElement("input",{onChange:this.onFileChange,name:"photo",type:"file",placeholder:"choose photo"})),s.a.createElement("p",null,s.a.createElement("label",null,"salary"),s.a.createElement("input",{onChange:this.onSalaryChange,placeholder:"".concat(this.props.user.info.salary," UAH"),name:"salary",type:"number"})),s.a.createElement("p",null,s.a.createElement("label",null,"Post"),s.a.createElement("input",{onChange:this.onPostChange,placeholder:"".concat(this.props.user.info.post||"enter your post"),name:"post",type:"text"})),s.a.createElement("p",null,s.a.createElement("label",null,"Phone"),s.a.createElement("input",{onChange:this.onPhoneChange,placeholder:"".concat(this.props.user.info.phone||"+380123456789"),name:"phone",type:"tel"})),s.a.createElement("p",null,s.a.createElement("label",null,"Work Days"),s.a.createElement("div",{className:"wd"},s.a.createElement("label",null,"Monday"),this.props.user.info.workDays&&-1!=this.props.user.info.workDays.indexOf(1)?s.a.createElement("input",{checked:!0,onChange:this.onWorkDaysChange,value:"1",type:"checkbox",name:"workDay",id:""}):s.a.createElement("input",{onChange:this.onWorkDaysChange,value:"1",type:"checkbox",name:"workDay",id:""})),s.a.createElement("div",{className:"wd"},s.a.createElement("label",null,"Tuesday"),this.props.user.info.workDays&&-1!=this.props.user.info.workDays.indexOf(2)?s.a.createElement("input",{checked:!0,onChange:this.onWorkDaysChange,value:"2",type:"checkbox",name:"workDay",id:""}):s.a.createElement("input",{onChange:this.onWorkDaysChange,value:"2",type:"checkbox",name:"workDay",id:""})),s.a.createElement("div",{className:"wd"},s.a.createElement("label",null,"Wednesday"),this.props.user.info.workDays&&-1!=this.props.user.info.workDays.indexOf(3)?s.a.createElement("input",{checked:!0,onChange:this.onWorkDaysChange,value:"3",type:"checkbox",name:"workDay",id:""}):s.a.createElement("input",{onChange:this.onWorkDaysChange,value:"3",type:"checkbox",name:"workDay",id:""})),s.a.createElement("div",{className:"wd"},s.a.createElement("label",null,"Thursday"),this.props.user.info.workDays&&-1!=this.props.user.info.workDays.indexOf(4)?s.a.createElement("input",{checked:!0,onChange:this.onWorkDaysChange,value:"4",type:"checkbox",name:"workDay",id:""}):s.a.createElement("input",{onChange:this.onWorkDaysChange,value:"4",type:"checkbox",name:"workDay",id:""})),s.a.createElement("div",{className:"wd"},s.a.createElement("label",null,"Friday"),this.props.user.info.workDays&&-1!=this.props.user.info.workDays.indexOf(5)?s.a.createElement("input",{checked:!0,onChange:this.onWorkDaysChange,value:"5",type:"checkbox",name:"workDay",id:""}):s.a.createElement("input",{onChange:this.onWorkDaysChange,value:"5",type:"checkbox",name:"workDay",id:""})),s.a.createElement("div",{className:"wd"},s.a.createElement("label",null,"Saturday"),this.props.user.info.workDays&&-1!=this.props.user.info.workDays.indexOf(6)?s.a.createElement("input",{checked:!0,onChange:this.onWorkDaysChange,value:"6",type:"checkbox",name:"workDay",id:""}):s.a.createElement("input",{onChange:this.onWorkDaysChange,value:"6",type:"checkbox",name:"workDay",id:""})),s.a.createElement("div",{className:"wd"},s.a.createElement("label",null,"Sunday"),this.props.user.info.workDays&&-1!=this.props.user.info.workDays.indexOf(7)?s.a.createElement("input",{checked:!0,onChange:this.onWorkDaysChange,value:"7",type:"checkbox",name:"workDay",id:""}):s.a.createElement("input",{onChange:this.onWorkDaysChange,value:"7",type:"checkbox",name:"workDay",id:""}))),s.a.createElement("p",null,s.a.createElement("label",null,"Work times"),s.a.createElement("input",{onChange:this.onStartWorkTimeChange,name:"workStart",type:"time"}),s.a.createElement("input",{onChange:this.onEndWorkTimeChange,name:"workEnd",type:"time"})),s.a.createElement("input",{type:"submit",value:"Confirm"})),s.a.createElement("button",{className:"close-modal-btn",onClick:this.closeUserModal},"Close modal")))}}]),t}(n.Component);function F(e){return{addAuthentication:function(){return e(b())},removeAuthentication:function(){return e(C())}}}var q=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).logout=function(){N.a.post("/api/auth/logout",{token:localStorage.getItem("token")}).then(function(){a.props.removeAuthentication(),localStorage.removeItem("token"),window.location.reload()}).catch(function(e){console.error(e)})},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return s.a.createElement("span",Object.assign({},this.props,{onClick:this.logout}),this.props.children||"logout")}}]),t}(n.Component),R=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).state={redirect:null},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("token")||"";t&&""!==t?N.a.post("/api/auth/authorization",{token:t}).then(function(){e.props.successRedirect&&e.setState({redirect:s.a.createElement(h.a,{to:e.props.successRedirect})}),e.props.addAuthentication()}).catch(function(t){e.props.failureRedirect&&e.setState({redirect:s.a.createElement(h.a,{to:e.props.failureRedirect})}),e.props.removeAuthentication(),console.error("Failure authentication!")}):(console.error("No auth data is found!"),this.props.failureRedirect&&this.setState({redirect:s.a.createElement(h.a,{to:this.props.failureRedirect})}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"Auth"},this.state.redirect)}}]),t}(n.Component),L=Object(c.b)(null,F)(R),P=Object(c.b)(null,F)(q);a(107);O.a.setAppElement("#root");var G=function(e){var t=e.isAuthenticated;return s.a.createElement("div",null,0==t?s.a.createElement("nav",{className:"navigation"},s.a.createElement("li",{className:"navigation__item"},s.a.createElement(u.b,{to:"/sign-in"},"login")),s.a.createElement("li",{className:"navigation__item"},s.a.createElement(u.b,{to:"/sign-up"},"sign up"))):s.a.createElement("nav",{className:"navigation"},s.a.createElement("li",{className:"navigation__item"},s.a.createElement(u.b,{to:"/profile"},"home")),s.a.createElement("li",{className:"navigation__item"},s.a.createElement(u.b,{to:"/chat"},"chat")),s.a.createElement("li",{className:"navigation__item"},s.a.createElement(P,null))))},V=function(){return s.a.createElement(u.b,{className:"logo",to:"/profile"},s.a.createElement("img",{src:"https://www.okko.ua/adaptive/img/header/big-logo.svg",alt:"logo"}))},B=Object(c.b)(function(e){return{isAuthenticated:e.isAuthenticated}})(function(e){var t=e.isAuthenticated;return s.a.createElement("header",{className:"header"},s.a.createElement(V,null),t?s.a.createElement(M,null):null,s.a.createElement(G,{isAuthenticated:t}))}),J=a(20);var Z=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(J.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),!0===a.validateForm()?N.a.post("/api/auth/sign-in",{email:a.state.email,password:a.state.password}).then(function(e){var t=e.data;localStorage.setItem("token",t),a.props.addToken(t),a.props.addAuthentication()}).then(function(){try{a.props.success()}catch(e){console.error(e)}}).catch(function(e){localStorage.clear(),a.props.removeAuthentication(),console.error(e)}):alert("incorrect data")},a.state={email:"",password:""},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"validateForm",value:function(){return this.state.email.length>5&&this.state.password.length>8}},{key:"render",value:function(){return s.a.createElement("form",{className:"login-form",onSubmit:this.handleSubmit},s.a.createElement("input",{className:"email",value:this.state.email,type:"email",onChange:this.handleChange,name:"email",placeholder:"email",required:!0}),s.a.createElement("input",{className:"password",value:this.state.password,type:"password",onChange:this.handleChange,name:"password",placeholder:"password",required:!0}),s.a.createElement("button",{type:"submit"},"login"))}}]),t}(n.Component),z=Object(c.b)(function(e){return{token:e.token}},function(e){return{addToken:function(t){return e(y(t))},addAuthentication:function(){return e(b())},removeAuthentication:function(){return e(C())}}})(Z),H=(a(52),function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).successLogin=function(){a.setState({redirect:!0})},a.state={redirect:!1},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"auth-form"},s.a.createElement("h2",{className:"title"},"Login"),this.state.redirect?s.a.createElement(h.a,{to:"/profile"}):null,s.a.createElement(L,{successRedirect:"/profile"}),s.a.createElement(z,{success:this.successLogin}))}}]),t}(n.Component));var Q=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(J.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),!0===a.validateForm()?N.a.post("/api/auth/sign-up",{username:a.state.username,email:a.state.email,password:a.state.password}).then(function(e){var t=e.data;localStorage.setItem("token",t),a.props.addToken(t),a.props.addAuthentication()}).then(function(){try{a.props.success()}catch(e){console.error(e)}}).catch(function(e){localStorage.clear(),a.props.removeAuthentication(),console.error(e)}):alert("incorrect data")},a.state={username:"",email:"",reEmail:"",password:"",rePassword:""},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"validateForm",value:function(){return this.state.username.length>5&&""!==this.state.email&&""!==this.state.password&&this.state.email===this.state.reEmail&&this.state.password===this.state.rePassword}},{key:"render",value:function(){return s.a.createElement("form",{className:"registration-form",onSubmit:this.handleSubmit},s.a.createElement("input",{name:"username",type:"text",placeholder:"full name",onChange:this.handleChange,required:"required"}),s.a.createElement("input",{name:"email",type:"email",placeholder:"email",onChange:this.handleChange,required:"required"}),s.a.createElement("input",{name:"reEmail",type:"email",placeholder:"retype email",onChange:this.handleChange,required:"required"}),s.a.createElement("input",{name:"password",type:"password",placeholder:"password",onChange:this.handleChange,required:"required"}),s.a.createElement("input",{name:"rePassword",type:"password",placeholder:"retype password",onChange:this.handleChange,required:"required"}),s.a.createElement("button",{type:"submit"},"sign up"))}}]),t}(n.Component),$=Object(c.b)(function(e){return{token:e.token}},function(e){return{addToken:function(t){return e(y(t))},addAuthentication:function(){return e(b())},removeAuthentication:function(){return e(C())}}})(Q),K=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).successregistration=function(){a.setState({redirect:!0})},a.state={redirect:!1},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"auth-form"},s.a.createElement("h2",{className:"title"},"Registration"),this.state.redirect?s.a.createElement(h.a,{to:"/profile"}):null,s.a.createElement(L,{successRedirect:"/profile"}),s.a.createElement($,{success:this.successregistration}))}}]),t}(n.Component),X=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).handleUserUpdate=function(e){a.setState({user:e})},a.state={user:{info:{status:{work_times:{},work_days:[]}}}},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;N.a.post("/api/user/current-user",{token:localStorage.getItem("token")}).then(function(t){var a=t.data;e.setState({user:a}),console.log()}).catch(function(e){console.error(e)})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(L,{failureRedirect:"/sign-in"}),s.a.createElement(W,{onUpdating:this.handleUserUpdate,user:this.state.user}),s.a.createElement(x,{user:this.state.user}))}}]),t}(n.Component);a(108);var Y=function(e){var t=e.chat;return s.a.createElement("div",{className:"chat-view"},s.a.createElement("div",{className:"chat-view__poster"},s.a.createElement("img",{src:"https://ik.imagekit.io/PrintOctopus/s/files/1/0006/0158/7777/products/dab_life.png?v=1554963498"})),s.a.createElement("div",{className:"chat-view__info"},s.a.createElement("div",{className:"chat-view__title"},t.name),s.a.createElement("div",{className:"chat-view__users-count"},"users: ",t.users.length-1),s.a.createElement("div",{className:"chat-view__messages-count"},"messages: ",t.messages.length),s.a.createElement("div",{className:"chat-view__latest-update"},function(e){var t=e.toString().slice(0,10),a=e.toString().slice(11,16);return"".concat(t," ").concat(a)}(t.updatedAt))))},ee=function(e){return Array.isArray(e.chats)?s.a.createElement("div",{className:"chats"},s.a.createElement("ul",{className:"chat-list"},s.a.createElement("h3",null,"Users chats:"),e.chats.filter(function(e){return"conversation"===e.name}).map(function(e){return s.a.createElement("li",{key:e._id,className:"chat-list__item"},s.a.createElement(u.b,{to:"/chat/conversation/"+e.users[1].toString()},s.a.createElement(Y,{chat:e})))})),s.a.createElement("ul",{className:"chat-list"},s.a.createElement("h3",null,"Group chats:"),e.chats.filter(function(e){return"conversation"!==e.name}).map(function(e){return s.a.createElement("li",{key:e._id,className:"chat-list__item"},s.a.createElement(u.b,{to:"/chat/discussion/"+e._id.toString()},s.a.createElement(Y,{chat:e})))}))):null},te=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(J.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),!0===a.validateForm()?N.a.post("/api/chat/create",{token:localStorage.getItem("token"),private:!1,name:a.state.chatName}).then(function(e){var t=e.data;a.props.afterCreate&&a.props.afterCreate(t)}).catch(function(e){console.log(e),alert("Cannot create chat! Try again(")}):alert("incorrect data")},a.state={chatName:""},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"validateForm",value:function(){return""!==this.state.chatName}},{key:"render",value:function(){return s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",onChange:this.handleChange,name:"chatName",placeholder:"Chat name",required:"required"}),s.a.createElement("button",{type:"submit"},"create"))}}]),t}(n.Component),ae=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).showAddUsersToChatModal=function(){a.setState({addUserToChatModalIsOpen:!0})},a.hideAddUsersToChatModal=function(){a.setState({addUserToChatModalIsOpen:!1,requestProcessing:!1})},a.findUsers=function(e){a.setState({requestProcessing:!0}),N.a.post("/api/users",{name:e,token:localStorage.getItem("token")}).then(function(e){var t=e.data;a.setState({users:t,requestProcessing:!1})}).catch(function(e){console.log(e),a.setState({requestProcessing:!1})})},a.handleUsersChange=function(e){""===e.target.value?a.setState({users:[]}):a.findUsers(e.target.value)},a.addUser=function(e){N.a.post("/api/chat/add-user",{token:localStorage.getItem("token"),userId:e,chatId:a.props.chatId}).then(function(e){a.setState({users:[]})}).catch(function(e){console.error(e)})},a.state={addUserToChatModalIsOpen:!1,users:[]},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"add-user-btn"},s.a.createElement("button",{onClick:this.showAddUsersToChatModal},"add user"),s.a.createElement(O.a,{isOpen:this.state.addUserToChatModalIsOpen,onRequestClose:this.hideAddUsersToChatModal,contentLabel:"Add users"},s.a.createElement("h2",null,"Add users to chat:"),s.a.createElement("input",{placeholder:"Enter username...",className:"add-users-to-chat-input",onChange:this.handleUsersChange}),s.a.createElement("ul",{className:"add-users-to-chat-list"},this.state.users.map(function(t){return s.a.createElement("li",{key:t._id},s.a.createElement(T,{user:t}),-1===t.info.chats.indexOf(e.props.chatId)?s.a.createElement("button",{className:"add-users-to-chat-btn",onClick:function(){e.addUser(t._id)}},"add user"):null)})),s.a.createElement("button",{className:"close-modal-btn",onClick:this.hideAddUsersToChatModal},"Close modal")))}}]),t}(n.Component);O.a.setAppElement("#root");var ne=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).showCreateChatForm=function(){a.setState({createChatModalIsOpen:!0})},a.closeCreateChatForm=function(){a.setState({createChatModalIsOpen:!1})},a.afterChatCreate=function(e){a.setState({chats:a.state.chats.concat(e)}),a.closeCreateChatForm()},a.state={createChatModalIsOpen:!1,chats:[]},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;N.a.post("/api/chat/chat-rooms",{token:localStorage.getItem("token")}).then(function(t){var a=t.data;e.setState({chats:a})}).catch(function(e){console.error(e)})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(L,{failureRedirect:"/sign-in"}),s.a.createElement(O.a,{isOpen:this.state.createChatModalIsOpen,onRequestClose:this.closeCreateChatForm,contentLabel:"Create chat"},s.a.createElement(te,{afterCreate:this.afterChatCreate}),s.a.createElement("button",{className:"close-modal-btn",onClick:this.closeCreateChatForm},"Close modal")),s.a.createElement("button",{className:"create-chat-btn",onClick:this.showCreateChatForm},"Create chat"),s.a.createElement(ee,{chats:this.state.chats}))}}]),t}(n.Component),se=a(69),re=a.n(se),oe=(a(138),function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(I.a)(this,Object(D.a)(t).call(this,e))).getConversationMessages=function(e){N.a.post("/api/chat/conversation",{token:localStorage.getItem("token"),interlocutorId:e}).then(function(t){var n=t.data;return a.setState({chatId:n._id,interlocutorId:e}),n._id}).then(function(e){N.a.post("/api/chat/messages",{token:localStorage.getItem("token"),chatId:e}).then(function(e){var t=e.data;a.setState({messages:t})})}).catch(function(e){console.error(e)})},a.getDiscussionMessages=function(e){N.a.post("/api/chat/discussion",{token:localStorage.getItem("token"),chatId:e}).then(function(e){var t=e.data;return a.setState({chatId:t._id}),t._id}).then(function(e){N.a.post("/api/chat/messages",{token:localStorage.getItem("token"),chatId:e}).then(function(e){var t=e.data;a.setState({messages:t})})}).catch(function(e){console.error(e)})},a.sendMessage=function(e){e.preventDefault(),N.a.post("/api/chat/message",{token:localStorage.getItem("token"),message:a.state.sendingMessage,chatId:a.state.chatId,interlocutorId:a.state.interlocutorId}).then(function(t){var n=t.data;try{a.state.socket.emit("chat message",{room:a.props.match.params.chatId,message:n})}catch(e){}finally{a.textInput.current.value="",a.setState({messages:a.state.messages.concat(n),sendingMessage:""})}}).catch(function(e){console.error(e)})},a.handleMessageChange=function(e){a.setState({sendingMessage:e.target.value})},a.textInput=s.a.createRef(),a.state={messages:[],sendingMessage:"",chatId:null,interlocutorId:null,socket:null},a}return Object(U.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params,a=t.chatId,n=t.direction;switch(N.a.get("/api/hostname").then(function(t){var a=re()("localhost:3000"==t.data?"localhost:5000":t.data);e.setState({socket:a})}).then(function(){e.state.socket.emit("join to room",{chatId:a}),e.state.socket.on("message",function(t){var a=t.message;e.setState({messages:e.state.messages.concat(a)})})}).catch(function(e){console.error(e)}),n){case"conversation":this.getConversationMessages(a);break;case"discussion":this.getDiscussionMessages(a);break;default:console.log("redirect to error page")}}},{key:"componentDidUpdate",value:function(e,t){if(e.match.params==this.props.match.params)return!1;var a=this.props.match.params,n=a.chatId;switch(a.direction){case"conversation":this.getConversationMessages(n);break;case"discussion":this.getDiscussionMessages(n);break;default:console.log("redirect to error page")}}},{key:"render",value:function(){return s.a.createElement("div",{className:"messages-container"},"discussion"===this.props.match.params.direction?s.a.createElement(ae,{chatId:this.state.chatId}):null,s.a.createElement("ul",{className:"messages-list"},this.state.messages.map(function(e){return s.a.createElement("li",{key:e._id},s.a.createElement("div",{className:"user-view"},s.a.createElement("div",{className:"user-view__picture"},s.a.createElement("img",{src:e.author.info.photo||"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTc5zNZV5Uc6ZwS4JAxBVS0DiqUtIAR_Q5u6-G42vMfNk3mFFLj"})),s.a.createElement("div",{className:"user-view__info"},s.a.createElement("span",{className:"user-view__name"},e.author.info.name),s.a.createElement("span",{className:"user-view__email"},e.author.email))),s.a.createElement("p",{className:"message"},e.text))})),s.a.createElement("form",{className:"message-form",onSubmit:this.sendMessage},s.a.createElement("input",{ref:this.textInput,type:"text",required:"required",onChange:this.handleMessageChange,placeholder:"Enter message..."}),s.a.createElement("button",{type:"submit"},"send")))}}]),t}(n.Component));a(139);window.store=E,window.addArticle=function(e){return{type:d,payload:e}},window.addToken=y,o.a.render(s.a.createElement(c.a,{store:E},s.a.createElement(u.a,null,s.a.createElement(L,{failureRedirect:"/sign-in"}),s.a.createElement(B,null),s.a.createElement(h.d,null,s.a.createElement(h.b,{path:"/sign-in",component:H}),s.a.createElement(h.b,{path:"/sign-up",component:K}),s.a.createElement(h.b,{path:"/profile",component:X}),s.a.createElement(h.b,{exact:!0,path:"/chat",component:ne}),s.a.createElement(h.b,{path:"/chat/:direction/:chatId",component:oe})))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");i?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):l(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):l(t,e)})}}()},52:function(e,t,a){},70:function(e,t,a){e.exports=a(140)},80:function(e,t,a){}},[[70,1,2]]]);
//# sourceMappingURL=main.be3d85b5.chunk.js.map